<!DOCTYPE html>
<html lang="en-us">

<head><title>
    Entity Framework Code First 資料庫初始化設定 | 
    
    My New Hugo Site</title>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="description" content="在參考了entityFramework套件之後，設定檔中會自動增加一個EntityFramework的區域設定 其中的defaultConnectionFactory宣告了預設的資料庫位置 不同的版本預設的localdb實體名稱會有不同，這邊的例子是mssqllocaldb
&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt; &lt;configuration&gt; &lt;configSections&gt; &lt;!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --&gt; &lt;section name=&#34;entityFramework&#34; type=&#34;System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&#34; requirePermission=&#34;false&#34; /&gt; &lt;/configSections&gt; &lt;startup&gt; &lt;supportedRuntime version=&#34;v4.0&#34; sku=&#34;.NETFramework,Version=v4.5&#34; /&gt; &lt;/startup&gt; &lt;entityFramework&gt; &lt;defaultConnectionFactory type=&#34;System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework&#34;&gt; &lt;parameters&gt; &lt;parameter value=&#34;mssqllocaldb&#34; /&gt; &lt;/parameters&gt; &lt;/defaultConnectionFactory&gt; &lt;providers&gt; &lt;provider invariantName=&#34;System.Data.SqlClient&#34; type=&#34;System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer&#34; /&gt; &lt;/providers&gt; &lt;/entityFramework&gt; &lt;/configuration&gt;  就會自動建立一個包含完整Assembly名稱的資料庫 [![](http://3.bp.blogspot.com/-u6i3p3OnimM/VFNEtuySOlI/AAAAAAAABtk/lDxVN9zSfD8/s1600/db.png)](http://3.bp.blogspot.com/-u6i3p3OnimM/VFNEtuySOlI/AAAAAAAABtk/lDxVN9zSfD8/s1600/db.png) 如果在設定檔的連線區段中，有一個和DbContext同名的設定值，就會改用這邊的連線設定 建立的資料庫也會是連線字串中指定的名稱
&lt;connectionStrings&gt; &lt;add name=&#34;DemoContext&#34; providerName=&#34;System.Data.SqlClient&#34; connectionString=&#34;Data Source=(localdb)\v11.0;Initial Catalog=Demo;Integrated Security=true;&#34;/&gt; &lt;/connectionStrings&gt;[![](http://2.bp.blogspot.com/-B1iIDWV-srg/VFNGwAUTTXI/AAAAAAAABt4/eI2Gmbx2deY/s1600/02.%E9%80%A3%E7%B7%9A%E5%AD%97%E4%B8%B2.png)](http://2.bp.blogspot.com/-B1iIDWV-srg/VFNGwAUTTXI/AAAAAAAABt4/eI2Gmbx2deY/s1600/02.%E9%80%A3%E7%B7%9A%E5%AD%97%E4%B8%B2.png) 也可以透過預設建構式指定要使用設定檔中的那個值 &lt;connectionStrings&gt; &lt;add name=&#34;
    ">


<meta property="og:title" content="Entity Framework Code First 資料庫初始化設定" />
<meta property="og:description" content="在參考了entityFramework套件之後，設定檔中會自動增加一個EntityFramework的區域設定 其中的defaultConnectionFactory宣告了預設的資料庫位置 不同的版本預設的localdb實體名稱會有不同，這邊的例子是mssqllocaldb
&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt; &lt;configuration&gt; &lt;configSections&gt; &lt;!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --&gt; &lt;section name=&#34;entityFramework&#34; type=&#34;System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&#34; requirePermission=&#34;false&#34; /&gt; &lt;/configSections&gt; &lt;startup&gt; &lt;supportedRuntime version=&#34;v4.0&#34; sku=&#34;.NETFramework,Version=v4.5&#34; /&gt; &lt;/startup&gt; &lt;entityFramework&gt; &lt;defaultConnectionFactory type=&#34;System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework&#34;&gt; &lt;parameters&gt; &lt;parameter value=&#34;mssqllocaldb&#34; /&gt; &lt;/parameters&gt; &lt;/defaultConnectionFactory&gt; &lt;providers&gt; &lt;provider invariantName=&#34;System.Data.SqlClient&#34; type=&#34;System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer&#34; /&gt; &lt;/providers&gt; &lt;/entityFramework&gt; &lt;/configuration&gt;  就會自動建立一個包含完整Assembly名稱的資料庫 [![](http://3.bp.blogspot.com/-u6i3p3OnimM/VFNEtuySOlI/AAAAAAAABtk/lDxVN9zSfD8/s1600/db.png)](http://3.bp.blogspot.com/-u6i3p3OnimM/VFNEtuySOlI/AAAAAAAABtk/lDxVN9zSfD8/s1600/db.png) 如果在設定檔的連線區段中，有一個和DbContext同名的設定值，就會改用這邊的連線設定 建立的資料庫也會是連線字串中指定的名稱
&lt;connectionStrings&gt; &lt;add name=&#34;DemoContext&#34; providerName=&#34;System.Data.SqlClient&#34; connectionString=&#34;Data Source=(localdb)\v11.0;Initial Catalog=Demo;Integrated Security=true;&#34;/&gt; &lt;/connectionStrings&gt;[![](http://2.bp.blogspot.com/-B1iIDWV-srg/VFNGwAUTTXI/AAAAAAAABt4/eI2Gmbx2deY/s1600/02.%E9%80%A3%E7%B7%9A%E5%AD%97%E4%B8%B2.png)](http://2.bp.blogspot.com/-B1iIDWV-srg/VFNGwAUTTXI/AAAAAAAABt4/eI2Gmbx2deY/s1600/02.%E9%80%A3%E7%B7%9A%E5%AD%97%E4%B8%B2.png) 也可以透過預設建構式指定要使用設定檔中的那個值 &lt;connectionStrings&gt; &lt;add name=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/posts/2014/10/entity-framework-code-first-%E8%B3%87%E6%96%99%E5%BA%AB%E5%88%9D%E5%A7%8B%E5%8C%96%E8%A8%AD%E5%AE%9A/" />
<meta property="article:published_time" content="2014-10-31T17:32:00+00:00" />
<meta property="article:modified_time" content="2014-10-31T17:32:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Entity Framework Code First 資料庫初始化設定"/>
<meta name="twitter:description" content="在參考了entityFramework套件之後，設定檔中會自動增加一個EntityFramework的區域設定 其中的defaultConnectionFactory宣告了預設的資料庫位置 不同的版本預設的localdb實體名稱會有不同，這邊的例子是mssqllocaldb
&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt; &lt;configuration&gt; &lt;configSections&gt; &lt;!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --&gt; &lt;section name=&#34;entityFramework&#34; type=&#34;System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&#34; requirePermission=&#34;false&#34; /&gt; &lt;/configSections&gt; &lt;startup&gt; &lt;supportedRuntime version=&#34;v4.0&#34; sku=&#34;.NETFramework,Version=v4.5&#34; /&gt; &lt;/startup&gt; &lt;entityFramework&gt; &lt;defaultConnectionFactory type=&#34;System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework&#34;&gt; &lt;parameters&gt; &lt;parameter value=&#34;mssqllocaldb&#34; /&gt; &lt;/parameters&gt; &lt;/defaultConnectionFactory&gt; &lt;providers&gt; &lt;provider invariantName=&#34;System.Data.SqlClient&#34; type=&#34;System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer&#34; /&gt; &lt;/providers&gt; &lt;/entityFramework&gt; &lt;/configuration&gt;  就會自動建立一個包含完整Assembly名稱的資料庫 [![](http://3.bp.blogspot.com/-u6i3p3OnimM/VFNEtuySOlI/AAAAAAAABtk/lDxVN9zSfD8/s1600/db.png)](http://3.bp.blogspot.com/-u6i3p3OnimM/VFNEtuySOlI/AAAAAAAABtk/lDxVN9zSfD8/s1600/db.png) 如果在設定檔的連線區段中，有一個和DbContext同名的設定值，就會改用這邊的連線設定 建立的資料庫也會是連線字串中指定的名稱
&lt;connectionStrings&gt; &lt;add name=&#34;DemoContext&#34; providerName=&#34;System.Data.SqlClient&#34; connectionString=&#34;Data Source=(localdb)\v11.0;Initial Catalog=Demo;Integrated Security=true;&#34;/&gt; &lt;/connectionStrings&gt;[![](http://2.bp.blogspot.com/-B1iIDWV-srg/VFNGwAUTTXI/AAAAAAAABt4/eI2Gmbx2deY/s1600/02.%E9%80%A3%E7%B7%9A%E5%AD%97%E4%B8%B2.png)](http://2.bp.blogspot.com/-B1iIDWV-srg/VFNGwAUTTXI/AAAAAAAABt4/eI2Gmbx2deY/s1600/02.%E9%80%A3%E7%B7%9A%E5%AD%97%E4%B8%B2.png) 也可以透過預設建構式指定要使用設定檔中的那個值 &lt;connectionStrings&gt; &lt;add name=&#34;"/>

<meta itemprop="name" content="Entity Framework Code First 資料庫初始化設定">
<meta itemprop="description" content="在參考了entityFramework套件之後，設定檔中會自動增加一個EntityFramework的區域設定 其中的defaultConnectionFactory宣告了預設的資料庫位置 不同的版本預設的localdb實體名稱會有不同，這邊的例子是mssqllocaldb
&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt; &lt;configuration&gt; &lt;configSections&gt; &lt;!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --&gt; &lt;section name=&#34;entityFramework&#34; type=&#34;System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&#34; requirePermission=&#34;false&#34; /&gt; &lt;/configSections&gt; &lt;startup&gt; &lt;supportedRuntime version=&#34;v4.0&#34; sku=&#34;.NETFramework,Version=v4.5&#34; /&gt; &lt;/startup&gt; &lt;entityFramework&gt; &lt;defaultConnectionFactory type=&#34;System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework&#34;&gt; &lt;parameters&gt; &lt;parameter value=&#34;mssqllocaldb&#34; /&gt; &lt;/parameters&gt; &lt;/defaultConnectionFactory&gt; &lt;providers&gt; &lt;provider invariantName=&#34;System.Data.SqlClient&#34; type=&#34;System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer&#34; /&gt; &lt;/providers&gt; &lt;/entityFramework&gt; &lt;/configuration&gt;  就會自動建立一個包含完整Assembly名稱的資料庫 [![](http://3.bp.blogspot.com/-u6i3p3OnimM/VFNEtuySOlI/AAAAAAAABtk/lDxVN9zSfD8/s1600/db.png)](http://3.bp.blogspot.com/-u6i3p3OnimM/VFNEtuySOlI/AAAAAAAABtk/lDxVN9zSfD8/s1600/db.png) 如果在設定檔的連線區段中，有一個和DbContext同名的設定值，就會改用這邊的連線設定 建立的資料庫也會是連線字串中指定的名稱
&lt;connectionStrings&gt; &lt;add name=&#34;DemoContext&#34; providerName=&#34;System.Data.SqlClient&#34; connectionString=&#34;Data Source=(localdb)\v11.0;Initial Catalog=Demo;Integrated Security=true;&#34;/&gt; &lt;/connectionStrings&gt;[![](http://2.bp.blogspot.com/-B1iIDWV-srg/VFNGwAUTTXI/AAAAAAAABt4/eI2Gmbx2deY/s1600/02.%E9%80%A3%E7%B7%9A%E5%AD%97%E4%B8%B2.png)](http://2.bp.blogspot.com/-B1iIDWV-srg/VFNGwAUTTXI/AAAAAAAABt4/eI2Gmbx2deY/s1600/02.%E9%80%A3%E7%B7%9A%E5%AD%97%E4%B8%B2.png) 也可以透過預設建構式指定要使用設定檔中的那個值 &lt;connectionStrings&gt; &lt;add name=&#34;">
<meta itemprop="datePublished" content="2014-10-31T17:32:00+00:00" />
<meta itemprop="dateModified" content="2014-10-31T17:32:00+00:00" />
<meta itemprop="wordCount" content="332">



<meta itemprop="keywords" content="Code First,Entity Framework," />

<link rel="canonical" href="http://example.org/posts/2014/10/entity-framework-code-first-%E8%B3%87%E6%96%99%E5%BA%AB%E5%88%9D%E5%A7%8B%E5%8C%96%E8%A8%AD%E5%AE%9A/" />

<link rel="icon" type="image/png" href="http://example.org/image/favicon.ico">

<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/bulma.min.css">





<script src=/js/ramium.js></script>
<link rel="stylesheet" href=/css/ramium.css>






<script data-ad-client="ca-pub-5338947003335320" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>

<body><nav class="navbar is-dark" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href=/>
      
      <strong>My New Hugo Site </strong>
      
    </a>

    <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false"
      data-target="navbarBasicExample">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>

  <div id="navbarBasicExample" class="navbar-menu">
    <div class="navbar-start">
      
      
      <a class="navbar-item" href="/">Home</a>
      
      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">This Blog</a>
        <div class="navbar-dropdown">
          
          <a class="navbar-item" href="/tags/">All Tags</a>
          
          <a class="navbar-item" href="/sections/">All Sections</a>
          
          <a class="navbar-item" href="/posts/">All Posts</a>
          
        </div>
      </div>
      
      
    </div>

    <div class="navbar-end">
      
      <a class="navbar-item navgithub" href="https://github.com/rafed/ramium/" target="_blank">
        <i class="fa fa-github fa-2x"></i>
      </a>
      

      
    </div>
  </div>
</nav><div class="columns is-centered">
        <div id="page-body" class="column is-7">

<div class="content blog">
    <h1>Entity Framework Code First 資料庫初始化設定</h1>

    <div id="infobar" class="level is-mobile">
        <div class="level-left">
            
            <div class="level-item">
                <p class="subtitle info date">Oct 31, 2014
                </p>
            </div>
            

            <div class="level-item">
                <p class="subtitle info">
                    6 mins read
                </p>
            </div>
        </div>
        <div class="level-right is-hidden-touch">
            <div class="tags">
                
                <a class="tag is-dark is-rounded" href="/tags/code-first">Code First</a>
                
                <a class="tag is-dark is-rounded" href="/tags/entity-framework">Entity Framework</a>
                
            </div>
        </div>
    </div>

    <div class="tags is-hidden-desktop">
        
        <a class="tag is-dark is-rounded" href="/tags/code-first">Code first</a>
        
        <a class="tag is-dark is-rounded" href="/tags/entity-framework">Entity framework</a>
        
    </div>

    <div class="blog-text">
        

        <p>在參考了entityFramework套件之後，設定檔中會自動增加一個EntityFramework的區域設定
其中的defaultConnectionFactory宣告了預設的資料庫位置
不同的版本預設的localdb實體名稱會有不同，這邊的例子是mssqllocaldb</p>
<div><pre class="brush:xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;configuration&gt;
    &lt;configSections&gt;
        &lt;!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --&gt;
        &lt;section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" /&gt;
    &lt;/configSections&gt;
    &lt;startup&gt;
        &lt;supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5" /&gt;
    &lt;/startup&gt;
    &lt;entityFramework&gt;
        &lt;defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework"&gt;
            &lt;parameters&gt;
                &lt;parameter value="mssqllocaldb" /&gt;
            &lt;/parameters&gt;
        &lt;/defaultConnectionFactory&gt;
        &lt;providers&gt;
            &lt;provider invariantName="System.Data.SqlClient" type="System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer" /&gt;
        &lt;/providers&gt;
    &lt;/entityFramework&gt;
&lt;/configuration&gt;
</pre></div>
就會自動建立一個包含完整Assembly名稱的資料庫
<div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;">[![](http://3.bp.blogspot.com/-u6i3p3OnimM/VFNEtuySOlI/AAAAAAAABtk/lDxVN9zSfD8/s1600/db.png)](http://3.bp.blogspot.com/-u6i3p3OnimM/VFNEtuySOlI/AAAAAAAABtk/lDxVN9zSfD8/s1600/db.png)</div>
<p>如果在設定檔的連線區段中，有一個和DbContext同名的設定值，就會改用這邊的連線設定
建立的資料庫也會是連線字串中指定的名稱</p>
<div><pre class="brush:xml">&lt;connectionStrings&gt;
    &lt;add name="DemoContext" providerName="System.Data.SqlClient"
            connectionString="Data Source=(localdb)\v11.0;Initial Catalog=Demo;Integrated Security=true;"/&gt;
&lt;/connectionStrings&gt;</pre></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;">[![](http://2.bp.blogspot.com/-B1iIDWV-srg/VFNGwAUTTXI/AAAAAAAABt4/eI2Gmbx2deY/s1600/02.%E9%80%A3%E7%B7%9A%E5%AD%97%E4%B8%B2.png)](http://2.bp.blogspot.com/-B1iIDWV-srg/VFNGwAUTTXI/AAAAAAAABt4/eI2Gmbx2deY/s1600/02.%E9%80%A3%E7%B7%9A%E5%AD%97%E4%B8%B2.png)</div>
也可以透過預設建構式指定要使用設定檔中的那個值
<div><pre class="brush:xml">&lt;connectionStrings&gt;
    &lt;add name="DemoContext" providerName="System.Data.SqlClient"
            connectionString="Data Source=(localdb)\v11.0;Initial Catalog=Demo;Integrated Security=true;"/&gt;
    &lt;add name="d1" providerName="System.Data.SqlClient"
            connectionString="Data Source=(localdb)\v11.0;Initial Catalog=d1;Integrated Security=true;"/&gt;
&lt;/connectionStrings&gt;
</pre></div>
<div><pre class="brush:csharp">public class DemoContext : DbContext
{
    public DemoContext() : base("name=d1")
    {
    }
<pre><code>public DbSet&amp;lt;Class1&amp;gt; Class1 { get; set; }
</code></pre>
<p>}
</pre></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-dbjwZcEhoYw/VFNJwZsdzMI/AAAAAAAABuY/Vret3Kef1e0/s1600/d1.png"><img src="http://1.bp.blogspot.com/-dbjwZcEhoYw/VFNJwZsdzMI/AAAAAAAABuY/Vret3Kef1e0/s1600/d1.png" alt=""></a></div>
或是使用DbContext物件時，透過建構式傳入要使用的名稱</p>
<div><pre class="brush:xml">&lt;connectionStrings&gt;
    &lt;add name="DemoContext" providerName="System.Data.SqlClient"
            connectionString="Data Source=(localdb)\v11.0;Initial Catalog=Demo;Integrated Security=true;"/&gt;
    &lt;add name="d1" providerName="System.Data.SqlClient"
            connectionString="Data Source=(localdb)\v11.0;Initial Catalog=d1;Integrated Security=true;"/&gt;
    &lt;add name="d2" providerName="System.Data.SqlClient"
                connectionString="Data Source=(localdb)\v11.0;Initial Catalog=d2;Integrated Security=true;"/&gt;
&lt;/connectionStrings&gt;</pre></div>
<div><pre class="brush:csharp">public class DemoContext : DbContext
{
    public DemoContext() : base("name=d1")
    {
    }
<pre><code>public DemoContext(string name) : base(name)
{
}

public DbSet&amp;lt;Class1&amp;gt; Class1 { get; set; }
</code></pre>
<p>}</pre></div></p>
<div><pre class="brush:csharp">static void Main(string[] args)
{
    using (DemoContext db = new DemoContext("d2"))
    {
        db.Database.Initialize(true);
    }
}</pre></div>
<div class="separator" style="clear: both; text-align: center;">[![](http://3.bp.blogspot.com/-BhpDZY3FCIc/VFNLSgDVLuI/AAAAAAAABuk/GA9qeZJMc00/s1600/d2.png)](http://3.bp.blogspot.com/-BhpDZY3FCIc/VFNLSgDVLuI/AAAAAAAABuk/GA9qeZJMc00/s1600/d2.png)</div>
另一種建構式是傳入DbConnection物件，搭配contextOwnsConnection來決定是否要共用連線
<div><pre class="brush:csharp">public class DemoContext : DbContext
{
    public DemoContext() : base("name=d1")
    {
    }
<pre><code>public DemoContext(string name) : base(name)
{
}

public DemoContext(DbConnection connection) : base(connection, contextOwnsConnection: false)
{
}

public DbSet&amp;lt;Class1&amp;gt; Class1 { get; set; }
</code></pre>
<p>}
</pre></div>
如果共用連線的話，在第一個DbContext執行完後就會釋放連線
執行第二個DbContext物件的時後就會報錯</p>
<div><pre class="brush:csharp">static void Main(string[] args)
{
    SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["d1"].ConnectionString);
<pre><code>using (DemoContext db = new DemoContext(conn))
{
    Console.WriteLine(db.Class1.Count());
}

using (DemoContext db = new DemoContext(conn))
{
    Console.WriteLine(db.Class1.Count());
}
</code></pre>
<p>}
</pre></div>
System.Data.Entity.Database.SetInitializer函式可以用來初始化資料庫
System.Data.Entity.CreateDatabaseIfNotExists
只有在資料庫不存在的時後才會建立，這是預設的策略</p>
<p>System.Data.Entity.DropCreateDatabaseIfModelChanges
只有當資料庫結構發生變化的時後，才砍掉重練</p>
<p>System.Data.Entity.DropCreateDatabaseAlways
不管資料庫結構是否有改變，每次都砍掉重練</p>
<p>通常在應用程式的進入點例如Global.asax，Main會設置初始化策略
但是在切換環境的時後，要改變策略就要重新修改編譯部署
所以比較方便的方式，是配置在設定檔中，有兩種設定方式</p>
<p>一種是設定在AppSetting區段，設成Disabled就是禁用資料庫初始化功能</p>
<div><pre class="brush:csharp">&lt;appSettings&gt;
    &lt;add key="DatabaseInitializerForType ConsoleApplication1.Models.DemoContext, ConsoleApplication1"
            value="System.Data.Entity.DropCreateDatabaseIfModelChanges`1[[ConsoleApplication1.Models.DemoContext, ConsoleApplication1]], EntityFramework" /&gt;
    &lt;!--&lt;add key="DatabaseInitializerForType ConsoleApplication1.Models.DemoContext, ConsoleApplication1"
            value="Disabled" /&gt;--&gt;
&lt;/appSettings&gt;
</pre></div>
一種是設定在entityFramework的contextx區段
<div><pre class="brush:xml">&lt;entityFramework&gt;
    &lt;defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework"&gt;
        &lt;parameters&gt;
            &lt;parameter value="mssqllocaldb" /&gt;
        &lt;/parameters&gt;
    &lt;/defaultConnectionFactory&gt;
    &lt;contexts&gt;
        &lt;context type="ConsoleApplication1.Models.DemoContext, ConsoleApplication1"&gt;
            &lt;databaseInitializer type="System.Data.Entity.DropCreateDatabaseIfModelChanges`1[[ConsoleApplication1.Models.DemoContext, ConsoleApplication1]], EntityFramework" /&gt;
        &lt;/context&gt;
    &lt;/contexts&gt;
    &lt;providers&gt;
        &lt;provider invariantName="System.Data.SqlClient" type="System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer" /&gt;
    &lt;/providers&gt;
&lt;/entityFramework&gt;<div>
</div>
</pre></div>
最後可以新增一個自訂的策略，並覆寫Seed函式，就能在初始化資料庫的時後，執行自訂的動作，例如新增資料
<div><pre class="brush:csharp">public class MyInitialize : DropCreateDatabaseIfModelChanges&lt;DemoContext&gt;
{
    protected override void Seed(DemoContext context)
    {
        context.Class1.Add(new Class1 { C1 = "a" });
        context.Class1.Add(new Class1 { C1 = "b" });
        context.Class1.Add(new Class1 { C1 = "c" });
    }
}
</pre></div>
    </div>
</div><div id="social-media-share" class="has-text-centered">
	<p><i>Sharing is caring!</i></p>
	<br>
	
	<div class="share-buttons">
	    <a  href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fexample.org%2fposts%2f2014%2f10%2fentity-framework-code-first-%25E8%25B3%2587%25E6%2596%2599%25E5%25BA%25AB%25E5%2588%259D%25E5%25A7%258B%25E5%258C%2596%25E8%25A8%25AD%25E5%25AE%259A%2f"
	        onclick="socialMediaPopUp(this.href, '', 500, 500); return false;"
	        title="Share on Facebook. Opens in a new window.">
	        <img src=/img/icons/45px/facebook.png>
	    </a>

	    <a  href="https://twitter.com/intent/tweet?text=Entity%20Framework%20Code%20First%20%e8%b3%87%e6%96%99%e5%ba%ab%e5%88%9d%e5%a7%8b%e5%8c%96%e8%a8%ad%e5%ae%9a&url=http%3a%2f%2fexample.org%2fposts%2f2014%2f10%2fentity-framework-code-first-%25E8%25B3%2587%25E6%2596%2599%25E5%25BA%25AB%25E5%2588%259D%25E5%25A7%258B%25E5%258C%2596%25E8%25A8%25AD%25E5%25AE%259A%2f"
	        onclick="socialMediaPopUp(this.href, '', 500, 500); return false;"
	        title="Share on Twitter. Opens in a new window." >
	        <img src=/img/icons/45px/twitter.png>
	    </a>

		<a  href="http://www.reddit.com/submit?url=http%3a%2f%2fexample.org%2fposts%2f2014%2f10%2fentity-framework-code-first-%25E8%25B3%2587%25E6%2596%2599%25E5%25BA%25AB%25E5%2588%259D%25E5%25A7%258B%25E5%258C%2596%25E8%25A8%25AD%25E5%25AE%259A%2f"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on Reddit. Opens in a new window." >
	        <img src=/img/icons/45px/reddit.png>
	    </a>

	    <a  href="http://pinterest.com/pin/create/button/?url=http%3a%2f%2fexample.org%2fposts%2f2014%2f10%2fentity-framework-code-first-%25E8%25B3%2587%25E6%2596%2599%25E5%25BA%25AB%25E5%2588%259D%25E5%25A7%258B%25E5%258C%2596%25E8%25A8%25AD%25E5%25AE%259A%2f"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on Pinterest. Opens in a new window." >
	        <img src=/img/icons/45px/pinterest.png>
	    </a>

	    <a  href="http://www.tumblr.com/share/link?url=http%3a%2f%2fexample.org%2fposts%2f2014%2f10%2fentity-framework-code-first-%25E8%25B3%2587%25E6%2596%2599%25E5%25BA%25AB%25E5%2588%259D%25E5%25A7%258B%25E5%258C%2596%25E8%25A8%25AD%25E5%25AE%259A%2f"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on Tumblr. Opens in a new window." >
	        <img src=/img/icons/45px/tumblr.png>
	    </a>

		<a  href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fexample.org%2fposts%2f2014%2f10%2fentity-framework-code-first-%25E8%25B3%2587%25E6%2596%2599%25E5%25BA%25AB%25E5%2588%259D%25E5%25A7%258B%25E5%258C%2596%25E8%25A8%25AD%25E5%25AE%259A%2f
			&title=Entity%20Framework%20Code%20First%20%e8%b3%87%e6%96%99%e5%ba%ab%e5%88%9d%e5%a7%8b%e5%8c%96%e8%a8%ad%e5%ae%9a&summary=%e5%9c%a8%e5%8f%83%e8%80%83%e4%ba%86entityFramework%e5%a5%97%e4%bb%b6%e4%b9%8b%e5%be%8c%ef%bc%8c%e8%a8%ad%e5%ae%9a%e6%aa%94%e4%b8%ad%e6%9c%83%e8%87%aa%e5%8b%95%e5%a2%9e%e5%8a%a0%e4%b8%80%e5%80%8bEntityFramework%e7%9a%84%e5%8d%80%e5%9f%9f%e8%a8%ad%e5%ae%9a%20%e5%85%b6%e4%b8%ad%e7%9a%84defaultConnectionFactory%e5%ae%a3%e5%91%8a%e4%ba%86%e9%a0%90%e8%a8%ad%e7%9a%84%e8%b3%87%e6%96%99%e5%ba%ab%e4%bd%8d%e7%bd%ae%20%e4%b8%8d%e5%90%8c%e7%9a%84%e7%89%88%e6%9c%ac%e9%a0%90%e8%a8%ad%e7%9a%84localdb%e5%af%a6%e9%ab%94%e5%90%8d%e7%a8%b1%e6%9c%83%e6%9c%89%e4%b8%8d%e5%90%8c%ef%bc%8c%e9%80%99%e9%82%8a%e7%9a%84%e4%be%8b%e5%ad%90%e6%98%afmssqllocaldb%0a%26lt%3b%3fxml%20version%3d%221.0%22%20encoding%3d%22utf-8%22%3f%26gt%3b%20%26lt%3bconfiguration%26gt%3b%20%26lt%3bconfigSections%26gt%3b%20%26lt%3b%21--%20For%20more%20information%20on%20Entity%20Framework%20configuration%2c%20visit%20http%3a%2f%2fgo.microsoft.com%2ffwlink%2f%3fLinkID%3d237468%20--%26gt%3b%20%26lt%3bsection%20name%3d%22entityFramework%22%20type%3d%22System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection%2c%20EntityFramework%2c%20Version%3d6.0.0.0%2c%20Culture%3dneutral%2c%20PublicKeyToken%3db77a5c561934e089%22%20requirePermission%3d%22false%22%20%2f%26gt%3b%20%26lt%3b%2fconfigSections%26gt%3b%20%26lt%3bstartup%26gt%3b%20%26lt%3bsupportedRuntime%20version%3d%22v4.0%22%20sku%3d%22.NETFramework%2cVersion%3dv4.5%22%20%2f%26gt%3b%20%26lt%3b%2fstartup%26gt%3b%20%26lt%3bentityFramework%26gt%3b%20%26lt%3bdefaultConnectionFactory%20type%3d%22System.Data.Entity.Infrastructure.LocalDbConnectionFactory%2c%20EntityFramework%22%26gt%3b%20%26lt%3bparameters%26gt%3b%20%26lt%3bparameter%20value%3d%22mssqllocaldb%22%20%2f%26gt%3b%20%26lt%3b%2fparameters%26gt%3b%20%26lt%3b%2fdefaultConnectionFactory%26gt%3b%20%26lt%3bproviders%26gt%3b%20%26lt%3bprovider%20invariantName%3d%22System.Data.SqlClient%22%20type%3d%22System.Data.Entity.SqlServer.SqlProviderServices%2c%20EntityFramework.SqlServer%22%20%2f%26gt%3b%20%26lt%3b%2fproviders%26gt%3b%20%26lt%3b%2fentityFramework%26gt%3b%20%26lt%3b%2fconfiguration%26gt%3b%20%20%e5%b0%b1%e6%9c%83%e8%87%aa%e5%8b%95%e5%bb%ba%e7%ab%8b%e4%b8%80%e5%80%8b%e5%8c%85%e5%90%ab%e5%ae%8c%e6%95%b4Assembly%e5%90%8d%e7%a8%b1%e7%9a%84%e8%b3%87%e6%96%99%e5%ba%ab%20%5b%21%5b%5d%28http%3a%2f%2f3.bp.blogspot.com%2f-u6i3p3OnimM%2fVFNEtuySOlI%2fAAAAAAAABtk%2flDxVN9zSfD8%2fs1600%2fdb.png%29%5d%28http%3a%2f%2f3.bp.blogspot.com%2f-u6i3p3OnimM%2fVFNEtuySOlI%2fAAAAAAAABtk%2flDxVN9zSfD8%2fs1600%2fdb.png%29%20%e5%a6%82%e6%9e%9c%e5%9c%a8%e8%a8%ad%e5%ae%9a%e6%aa%94%e7%9a%84%e9%80%a3%e7%b7%9a%e5%8d%80%e6%ae%b5%e4%b8%ad%ef%bc%8c%e6%9c%89%e4%b8%80%e5%80%8b%e5%92%8cDbContext%e5%90%8c%e5%90%8d%e7%9a%84%e8%a8%ad%e5%ae%9a%e5%80%bc%ef%bc%8c%e5%b0%b1%e6%9c%83%e6%94%b9%e7%94%a8%e9%80%99%e9%82%8a%e7%9a%84%e9%80%a3%e7%b7%9a%e8%a8%ad%e5%ae%9a%20%e5%bb%ba%e7%ab%8b%e7%9a%84%e8%b3%87%e6%96%99%e5%ba%ab%e4%b9%9f%e6%9c%83%e6%98%af%e9%80%a3%e7%b7%9a%e5%ad%97%e4%b8%b2%e4%b8%ad%e6%8c%87%e5%ae%9a%e7%9a%84%e5%90%8d%e7%a8%b1%0a%26lt%3bconnectionStrings%26gt%3b%20%26lt%3badd%20name%3d%22DemoContext%22%20providerName%3d%22System.Data.SqlClient%22%20connectionString%3d%22Data%20Source%3d%28localdb%29%5cv11.0%3bInitial%20Catalog%3dDemo%3bIntegrated%20Security%3dtrue%3b%22%2f%26gt%3b%20%26lt%3b%2fconnectionStrings%26gt%3b%5b%21%5b%5d%28http%3a%2f%2f2.bp.blogspot.com%2f-B1iIDWV-srg%2fVFNGwAUTTXI%2fAAAAAAAABt4%2feI2Gmbx2deY%2fs1600%2f02.%25E9%2580%25A3%25E7%25B7%259A%25E5%25AD%2597%25E4%25B8%25B2.png%29%5d%28http%3a%2f%2f2.bp.blogspot.com%2f-B1iIDWV-srg%2fVFNGwAUTTXI%2fAAAAAAAABt4%2feI2Gmbx2deY%2fs1600%2f02.%25E9%2580%25A3%25E7%25B7%259A%25E5%25AD%2597%25E4%25B8%25B2.png%29%20%e4%b9%9f%e5%8f%af%e4%bb%a5%e9%80%8f%e9%81%8e%e9%a0%90%e8%a8%ad%e5%bb%ba%e6%a7%8b%e5%bc%8f%e6%8c%87%e5%ae%9a%e8%a6%81%e4%bd%bf%e7%94%a8%e8%a8%ad%e5%ae%9a%e6%aa%94%e4%b8%ad%e7%9a%84%e9%82%a3%e5%80%8b%e5%80%bc%20%26lt%3bconnectionStrings%26gt%3b%20%26lt%3badd%20name%3d%22&source=rafed123.github.io"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on LinkedIn. Opens in a new window." >
	        <img src=/img/icons/45px/linkedin.png>
	    </a>

	    <a  href="mailto:?subject=Entity%20Framework%20Code%20First%20%e8%b3%87%e6%96%99%e5%ba%ab%e5%88%9d%e5%a7%8b%e5%8c%96%e8%a8%ad%e5%ae%9a&amp;body=Check out this site http%3a%2f%2fexample.org%2fposts%2f2014%2f10%2fentity-framework-code-first-%25E8%25B3%2587%25E6%2596%2599%25E5%25BA%25AB%25E5%2588%259D%25E5%25A7%258B%25E5%258C%2596%25E8%25A8%25AD%25E5%25AE%259A%2f"
	        title="Share via Email. Opens in a new window." >
	        <img src=/img/icons/45px/mail.png>
	    </a>
	</div>
</div>


<br>
<div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = '';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


        </div>
    </div>

<footer class="footer has-background-dark">
    <div class="content has-text-centered has-text-white">
        <p>
            © 2020 Ramium. Powered by
            <a class="has-text-light" href="https://github.com/gohugoio/hugo" target="_blank">
            Hugo</a>. Theme
            <a class="has-text-light" href="https://github.com/rafed123/ramium/" target="_blank">
                Ramium.
            </a>
        </p>
    </div>
</footer>
</body>

</html>